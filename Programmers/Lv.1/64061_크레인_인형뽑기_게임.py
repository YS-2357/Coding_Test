# π“ 1. νμΌ μ λ©, λ¬Έμ  μ„¤λ…, μ…λ ¥/μ¶λ ¥ ν•μ‹, κ·μΉ™ μ”μ•½
# ------------------------------------------------------------
# νμΌλ…: 64061_ν¬λ μΈ_μΈν•λ½‘κΈ°_κ²μ„.py
# ν”λ«νΌ: ν”„λ΅κ·Έλλ¨Έμ¤ (Level 1)
# λ¬Έμ : 64061 ν¬λ μΈ μΈν•λ½‘κΈ° κ²μ„
# λ§ν¬: https://school.programmers.co.kr/learn/courses/30/lessons/64061
#
# [λ¬Έμ  μ„¤λ… μ”μ•½]
# - NΓ—N λ³΄λ“(board)μ—μ„ moves λ°°μ—΄μ— μ ν μ—΄ λ²νΈ(1-based) μμ„λ€λ΅
#   κ·Έ μ—΄μ "λ§¨ μ„ μΈν•"μ„ μ§‘μ–΄ λ°”κµ¬λ‹μ— λ‹΄λ” μ‹λ®¬λ μ΄μ… λ¬Έμ .
# - λ°”κµ¬λ‹(μ¤νƒ)μ λ§¨ μ„ λ‘ μΈν•μ΄ κ°™μ€ λ²νΈκ°€ λλ©΄ λ‘ μΈν•μ΄ μ¦‰μ‹ μ‚¬λΌμ§€κ³ ,
#   μ‚¬λΌμ§„ μΈν• μ(= μ μ)λ” 2μ”© μ¦κ°€ν•λ‹¤.
# - μµμΆ…μ μΌλ΅ μ‚¬λΌμ§„ μΈν•μ μ΄ κ°μλ¥Ό λ°ν™ν•λ‹¤.
#
# [μ…λ ¥ ν•μ‹]
# - board: List[List[int]] (NΓ—N), 0μ€ λΉμΉΈ, μ–‘μ μ •μλ” μΈν• λ²νΈ.
# - moves: List[int], κ° μ›μ†λ” λ½‘μ„ μ—΄ λ²νΈ(1-based).
#
# [μ¶λ ¥ ν•μ‹]
# - int: μ†λ©Έλ(μ‚¬λΌμ§„) μΈν• μ΄ κ°μ.
#
# [κ·μΉ™ μ”μ•½]
# - κ° moveμ— λ€ν•΄ ν•΄λ‹Ή μ—΄μ κ°€μ¥ μ„(ν–‰ μΈλ±μ¤κ°€ μ‘μ€)μ—μ„ 0μ΄ μ•„λ‹ κ°’ ν•λ‚λ¥Ό μ§‘λ”λ‹¤.
# - μ§‘μ€ μΈν•μ„ λ°”κµ¬λ‹(μ¤νƒ)μ— λ„£μ„ λ•, μ¤νƒ topκ³Ό λ²νΈκ°€ κ°™μΌλ©΄ λ‘ λ‹¤ μ κ±°λμ–΄ μ μ +2.
# - κ°™μ€ move λ‚΄μ—μ„ ν• λ²μ μ‚½μ…μΌλ΅ μµλ€ ν• λ²λ§ ν„°μ§ μ μλ‹¤(μ—°μ‡„ ν•„μ” μ—†μ).
# - λΉ μ—΄(λ” μ΄μƒ 0μ΄ μ•„λ‹ κ°’μ΄ μ—†μ)μ€ κ±΄λ„λ›΄λ‹¤.
#
# [κ¶μ¥ μ•κ³ λ¦¬μ¦/μλ£κµ¬μ΅°]
# - λ°”κµ¬λ‹: μ¤νƒ(LIFO) μ‚¬μ© β†’ top λΉ„κµ ν›„ λ™μΌν•λ©΄ pop + μ μ 2.
# - μ—΄ νƒμƒ‰: λ‹¨μ μ„β†’μ•„λ μ„ ν• νƒμƒ‰(O(N)) λλ” μ—΄λ³„ ν¬μΈν„°/μ¤νƒ μ „μ²λ¦¬λ΅ O(1)ν™” κ°€λ¥.
#
# [λ³µμ΅λ„(ν„ κµ¬ν„ κΈ°μ¤€)]
# - μ „μ²λ¦¬: μ—†μ, κ° moveλ§λ‹¤ μµλ€ O(N) νƒμƒ‰
# - μ „μ²΄: O(N * len(moves))  (Nμ€ λ³΄λ“ ν• λ³€)
# - κ³µκ°„: O(len(moves)) (λ°”κµ¬λ‹) + μ…λ ¥ λ³΄λ“
# ------------------------------------------------------------


# π“ 2. μ •λ‹µ μ½”λ“ (λ‚μ μ›λ³Έ ν’€μ΄, μ λ€ μμ • κΈμ§€)
def solution(board, moves):
    answer = 0  # μ†λ©Έλ μΈν•μ μ΄ κ°μλ¥Ό κΈ°λ΅
    n, m = len(board), len(board[0])  # λ³΄λ“ ν¬κΈ° (ν–‰, μ—΄) β†’ mμ€ μ‹¤μ  μ‚¬μ©λμ§€ μ•μ
    basket = []  # λ°”κµ¬λ‹ μ—­ν• μ„ ν•  μ¤νƒ

    for move in moves:  # κ° μ΄λ™(move)μ„ μμ„λ€λ΅ μ²λ¦¬
        for i in range(n):  # ν•΄λ‹Ή μ—΄μ—μ„ μ„μ½ ν–‰λ¶€ν„° νƒμƒ‰
            doll = board[i][move-1]  # moveλ” 1-based β†’ λ‚΄λ¶€λ” 0-basedλ΅ λ³€ν™
            if doll != 0:  # λΉμΉΈμ΄ μ•„λ‹λ©΄ μΈν•μ΄ μλ‹¤λ” λ»
                if basket and basket[-1] == doll:  # λ°”κµ¬λ‹κ°€ λΉ„μ–΄μμ§€ μ•κ³  topμ΄ λ™μΌν• μΈν•μ΄λ©΄
                    basket.pop()  # top μ κ±°
                    answer += 2  # μΈν• λ‘ κ° μ†λ©Έ β†’ μ μ +2
                    board[i][move-1] = 0  # μ§‘μ€ μΉΈμ€ λΉ„μ›μ¤
                    break  # μ΄λ² moveλ” μ²λ¦¬ λ
                else:  # λ°”κµ¬λ‹ topμ΄ λ‹¤λ¥΄κ±°λ‚ λΉ„μ–΄μλ‹¤λ©΄
                    basket.append(doll)  # μΈν•μ„ λ°”κµ¬λ‹μ— λ„£μ
                    board[i][move-1] = 0  # μ§‘μ€ μΉΈ λΉ„μ›€
                    break  # μ΄λ² move μ²λ¦¬ λ

    return answer  # μµμΆ… μ†λ©Έλ μΈν• μ΄ κ°μ λ°ν™


# π“ 3. μ²« μ‹λ„ κ²°κ³Ό, μ¤λ‹µ μ΄μ  λ° μ‹¤μ, μ‚¬μ©ν• μ•κ³ λ¦¬μ¦ κ°λ…
# ------------------------------------------------------------
# [μ²« μ‹λ„ κ²°κ³Ό]
# - μμ‹ μ…λ ¥ κΈ°λ° μ •μƒ λ™μ‘. λ°”κµ¬λ‹ μ¤νƒμΌλ΅ λ™μΌ μƒλ‹¨ 2κ° μ‹ μ†λ©Έ(+2) μ²λ¦¬.
# - μ‹κ°„λ³µμ΅λ„: κ° moveλ§λ‹¤ μ„β†’μ•„λ μ„ ν• νƒμƒ‰μΌλ΅ O(N). μΌλ°μ μΌλ΅ Nμ΄ ν¬μ§€ μ•μ•„ ν†µκ³Ό κ°€λ¥.
#
# [μ¤λ‹µ/μ‹¤μ κ°€λ¥ μ§€μ  μ κ²€]
# - (μ •ν™•μ„±) moveλ” 1-based β†’ λ‚΄λ¶€ μΈλ±μ¤μ—μ„ move-1 μ²λ¦¬: λ°μλμ–΄ μμ.
# - (μ •ν™•μ„±) μ§‘μ€ μΉΈμ„ 0μΌλ΅ μ΄κΈ°ν™”ν•΄μ•Ό μ¬μ‚¬μ© λ°©μ§€: λ°μλμ–΄ μμ.
# - (μ •ν™•μ„±) 0(λΉμΉΈ)μ€ λ°”κµ¬λ‹μ— λ„£μ§€ μ•μ: μ΅°κ±΄λ¬ΈμΌλ΅ λ°μ.
# - (μ½”λ“ ν’μ§) m λ³€μλ¥Ό μ„ μ–Έν–μΌλ‚ μ‚¬μ©ν•μ§€ μ•μ(κ²½λ―Έν• λ¶ν•„μ” λ³€μ).
# - (μ„±λ¥) λ§¤ moveλ§λ‹¤ ν•΄λ‹Ή μ—΄μ„ μ„β†’μ•„λλ΅ νƒμƒ‰(O(N)): μ…λ ¥μ΄ ν° κ²½μ° λΉ„ν¨μ¨μ μΌ μ μμ.
#
# [μ‚¬μ©ν• ν•„μ κ°λ…/μ•κ³ λ¦¬μ¦]
# - μ‹λ®¬λ μ΄μ… + μ¤νƒ(LIFO): λ°”κµ¬λ‹λ¥Ό λ¦¬μ¤νΈ μ¤νƒμΌλ΅ κ΄€λ¦¬, top λΉ„κµ ν›„ λ™μΌ μ‹ pop.
# - λ‹¨μ μ„ ν• νƒμƒ‰: κ° μ—΄μ—μ„ λ§¨ μ„ μΈν•μ„ μ°Ύμ„ λ• μ„β†’μ•„λλ΅ μ¤μΊ”.
# - μΈλ±μ¤ λ³€ν™: 1-based μ—΄ λ²νΈλ¥Ό 0-basedλ΅ λ³€ν™.
# ------------------------------------------------------------


# π“ 4. (μ„ νƒ) λ‹¤λ¥Έ ν¨μ¨μ μΈ ν’€μ΄ λλ” μ•κ³ λ¦¬μ¦ μ μ•  [μ½”λ“ μ κ³µ κΈμ§€, κ°λ…/νλ¦„λ§]
# ------------------------------------------------------------
# [μ—΄ ν¬μΈν„° λ°©μ‹]
# - κ° μ—΄λ§λ‹¤ "λ‹¤μ λ½‘ν ν–‰ μΈλ±μ¤(top_idx[col]])"λ¥Ό λ―Έλ¦¬ κ³„μ‚°ν•΄λ‘κ³ , move λ• O(1)μ— μ ‘κ·Ό.
# - νλ¦„:
#   1) μ΄κΈ°ν™” μ‹, κ° μ—΄μ— λ€ν•΄ μ„μ—μ„λ¶€ν„° μ²« λ²μ§Έ 0μ΄ μ•„λ‹ ν–‰ μΈλ±μ¤λ¥Ό κΈ°λ΅.
#   2) move μν–‰ μ‹ ν•΄λ‹Ή μ—΄μ top_idx[col]κ°€ κ°€λ¦¬ν‚¤λ” μΈν•μ„ μ¦‰μ‹ μ§‘μ–΄ μ²λ¦¬.
#   3) μΈν•μ„ μ§‘μ—λ‹¤λ©΄ top_idx[col] += 1 λ΅ λ‹¤μ ν›„λ³΄λ΅ μ΄λ™(0μ„ κ±΄λ„λ›°λ„λ΅ μ΄κΈ° λ‹¨κ³„μ—μ„ μ¤ν‚µ).
#
# [μ—΄ μ¤νƒ(λλ” λ°ν¬) μ „μ²λ¦¬]
# - κ° μ—΄μ„ "μ„μ—μ„ μ•„λ μ"μΌλ΅ λ‹΄μ€ μ¤νƒ/λ°ν¬λ΅ κµ¬μ„±ν•΄λ‘κ³ , moveλ§λ‹¤ popμΌλ΅ O(1) νλ“.
# - νλ¦„:
#   1) μ „μ²λ¦¬ λ‹¨κ³„μ—μ„ κ° μ—΄μ„ μνν•λ©° 0μ΄ μ•„λ‹ μΈν•λ§ μ¶”μ¶ν•μ—¬ μ»¬λ ‰μ…μ— μ“λ”λ‹¤.
#   2) move μν–‰ μ‹ ν•΄λ‹Ή μ—΄ μ»¬λ ‰μ…μ—μ„ pop β†’ λ°”κµ¬λ‹ μ¤νƒκ³Ό λΉ„κµ/μ†λ©Έ μ²λ¦¬.
#
# [μ¥μ ]
# - λ§¤ move μ²λ¦¬ λΉ„μ©μ„ O(1)μ— κ°€κΉκ² λ‚®μ¶° μ „μ²΄λ¥Ό O(N^2 + len(moves)) λλ” O(len(moves))λ΅ κ°μ„ .
# - λ΅μ§μ΄ λ°”κµ¬λ‹ μ¤νƒκ³Ό μ λ¶„λ¦¬λμ–΄ κ°€λ…μ„±β†‘, λ””λ²„κΉ… μ©μ΄.
#
# [μ—£μ§€/μ£Όμ]
# - μ „μ²λ¦¬ μ‹ 0μ€ μ μ™Έν•κ³  μ ν¨ μΈν•λ§ λ‹΄μ•„μ•Ό ν•¨.
# - moveκ°€ κ°€λ¦¬ν‚¤λ” μ—΄μ΄ λΉ„μ–΄μμ„ μ μμΌλ―€λ΅ μμ™Έ μΌ€μ΄μ¤(κ±΄λ„λ›°κΈ°) μ²λ¦¬ ν•„μ”.
# ------------------------------------------------------------
