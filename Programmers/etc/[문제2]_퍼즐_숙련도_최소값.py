# [ë¬¸ì œ2]_í¼ì¦_ìˆ™ë ¨ë„_ìµœì†Œê°’.py
# -----------------------------------------------------
# âœ… ë¬¸ì œ ì„¤ëª…:
# - í¼ì¦ nê°œ, ê° ë‚œì´ë„ diffs[i], ì‹œê°„ times[i]
# - ìˆ™ë ¨ë„ levelì— ë”°ë¼ diff > levelì´ë©´ (diff - level)ë²ˆ í‹€ë¦¬ê³ 
#   í‹€ë¦´ ë•Œë§ˆë‹¤ í˜„ì¬+ì´ì „ í¼ì¦ ì‹œê°„ ì†Œëª¨, ë§ˆì§€ë§‰ì— í•œ ë²ˆ ë” í˜„ì¬ í¼ì¦ ì‹œê°„ ì†Œëª¨
# - ì œí•œ ì‹œê°„ limit ë‚´ì— ëª¨ë‘ í’€ ìˆ˜ ìˆëŠ” ìµœì†Œ level êµ¬í•˜ê¸°.

# âœ… ì…ë ¥ í˜•ì‹:
# - diffs, times: ê¸¸ì´ n(1 â‰¤ n â‰¤ 300,000)
# - diffs[0] = 1, 1 â‰¤ diffs[i] â‰¤ 100,000
# - 1 â‰¤ times[i] â‰¤ 10,000
# - 1 â‰¤ limit â‰¤ 10^15
# - í•­ìƒ í•´ê°€ ì¡´ì¬

# âœ… ì¶œë ¥ í˜•ì‹:
# - ìµœì†Œ ìˆ™ë ¨ë„ level (ì •ìˆ˜)

# âœ… ì…ì¶œë ¥ ì˜ˆì‹œ:
# diffs=[1,5,3], times=[2,4,7], limit=30 â†’ 3

# âœ… ì •ë‹µ ì½”ë“œ:
def solution(diffs, times, limit):
    n = len(diffs)

    # ì£¼ì–´ì§„ levelì—ì„œ ì†Œìš” ì‹œê°„ ê³„ì‚°
    def total_time(level):
        total = times[0]                 # ì²« í¼ì¦ì€ ë‚œì´ë„ 1, ë¬´ì¡°ê±´ í•œ ë²ˆì— í•´ê²°
        for i in range(1, n):
            if level >= diffs[i]:
                total += times[i]
            else:
                fails = diffs[i] - level
                total += fails * (times[i] + times[i-1]) + times[i]
        return total

    # ì´ì§„ íƒìƒ‰ìœ¼ë¡œ ìµœì†Œ level ì°¾ê¸°
    lo, hi = 1, max(diffs)
    ans = hi
    while lo <= hi:
        mid = (lo + hi) // 2
        if total_time(mid) <= limit:
            ans = mid
            hi = mid - 1
        else:
            lo = mid + 1
    return ans

# -----------------------------------------------------
# ğŸ” ì²« ì‹œë„ ê²°ê³¼:
# - í•œ ë²ˆì— ì •ë‹µ ë„ì¶œ (íŒíŠ¸ ì‚¬ìš© ì•ˆ í•¨)

# ğŸ“š ì‚¬ìš©ëœ ê°œë… ìš”ì•½:
# - level â†’ ì‹œê°„ í•¨ìˆ˜ê°€ ë‹¨ì¡° ê°ì†Œí•¨ì„ ì´ìš©í•´ ì´ì§„ íƒìƒ‰
# - ê° í¼ì¦ ì‹œê°„ ê³„ì‚°: diff â‰¤ level â†’ ë‹¨ìˆœí•©, diff > level â†’ ì‹¤íŒ¨ íšŸìˆ˜ ê³„ì‚°
# - ì‹œê°„ë³µì¡ë„: O(n log max_diff)
