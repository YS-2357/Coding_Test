# 2092_Find_All_People_With_Secret.py
# -----------------------------------------------------
# âœ… ì œëª©: LeetCode 2092. Find All People With Secret
# âœ… ë¬¸ì œ ì„¤ëª…(ìš”ì•½):
#   - ì‚¬ëŒ 0ì€ ì‹œê°„ 0ì— ë¹„ë°€ì„ ì•Œê³  ìˆìœ¼ë©°, ì‹œê°„ 0ì— firstPersonì—ê²Œ ë¹„ë°€ì„ ê³µìœ í•œë‹¤.
#   - meetingsì—ëŠ” (x, y, t)ê°€ ì£¼ì–´ì§€ê³ , ì‹œê°„ tì— xì™€ yê°€ ë§Œë‚˜ë©´ ë¹„ë°€ì´ ì¦‰ì‹œ ê³µìœ ë  ìˆ˜ ìˆë‹¤.
#   - ë‹¨, ì–´ë–¤ ì‚¬ëŒì´ ì‹œê°„ tì— ë¹„ë°€ì„ ì•Œê²Œ ë˜ë©´, ê°™ì€ ì‹œê°„ tì˜ ë‹¤ë¥¸ ë§Œë‚¨ì—ì„œë„ ì „íŒŒê°€ ê°€ëŠ¥í•˜ë‹¤(ë™ì¼ ì‹œê°„ ë‚´ ë™ì‹œ ì „íŒŒ).
#   - ìµœì¢…ì ìœ¼ë¡œ ë¹„ë°€ì„ ì•Œê²Œ ë˜ëŠ” ëª¨ë“  ì‚¬ëŒì˜ ëª©ë¡ì„ ë°˜í™˜í•œë‹¤.
#
# âœ… ì…ë ¥ í˜•ì‹(ìš”ì§€):
#   - n: ì‚¬ëŒ ìˆ˜ (0 ~ n-1)
#   - meetings: [x, y, t] í˜•íƒœì˜ ë¦¬ìŠ¤íŠ¸ (ë§Œë‚¨ ì •ë³´)
#   - firstPerson: ì‹œê°„ 0ì— 0ìœ¼ë¡œë¶€í„° ë¹„ë°€ì„ ë°›ëŠ” ì‚¬ëŒ
#
# âœ… ê·œì¹™ ìš”ì•½:
#   - ì‹œê°„ t ê¸°ì¤€ìœ¼ë¡œ ì „íŒŒê°€ ì¼ì–´ë‚˜ë©°, ê°™ì€ ì‹œê°„ tì—ì„œì˜ ì „íŒŒëŠ” "ë™ì‹œ"ë¡œ ì²˜ë¦¬ë˜ì–´ì•¼ í•œë‹¤.
#   - ì²˜ë¦¬ ìˆœì„œê°€ ì•„ë‹Œ "ê°™ì€ ì‹œê°„ì— ì—°ê²°ëœ ì»´í¬ë„ŒíŠ¸" ë‹¨ìœ„ë¡œ ë¹„ë°€ì´ í™•ì‚°ë˜ëŠ”ì§€ íŒë‹¨í•´ì•¼ í•œë‹¤.
#   - ì„œë¡œ ë‹¤ë¥¸ ì‹œê°„ëŒ€ì˜ ì—°ê²°(ê°„ì„ )ì€ ìœ ì§€ë˜ë©´ ì•ˆ ë˜ë¯€ë¡œ, ì‹œê°„ ê·¸ë£¹ ì²˜ë¦¬ í›„ ì—°ê²° ìƒíƒœëŠ” ì´ˆê¸°í™”í•´ì•¼ í•œë‹¤.
#
# âœ… ì •ë‹µ ì½”ë“œ(ë‚˜ì˜ í’€ì´; ì ˆëŒ€ ìˆ˜ì • ê¸ˆì§€)
#   - ì•„ë˜ëŠ” ì‚¬ìš©ìê°€ ì œì¶œ/ì±„íƒí•œ ìµœì¢… ì •ë‹µ ì½”ë“œì´ë©°,
#     ì´ ë‹¨ê³„ì—ì„œëŠ” ì½”ë“œ ë‚´ìš©ì„ ë³€ê²½í•˜ì§€ ì•Šê³ ,
#     ê° ì¤„ë§ˆë‹¤ ì„¤ëª… ì£¼ì„ë§Œ ì¶”ê°€í•œë‹¤.

class Solution:
    def findAllPeople(self, n: int, meetings: List[List[int]], firstPerson: int) -> List[int]:
        meetings.sort(key=lambda x: x[2])                      # ì‹œê°„ t ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬(ì‹œê°„ ê·¸ë£¹ ë‹¨ìœ„ ì²˜ë¦¬ ëª©ì )
        parent = list(range(n))                                # DSU(Union-Find) ë¶€ëª¨ ë°°ì—´ ì´ˆê¸°í™”
        know = [False] * n                                     # know[i]: iê°€ ë¹„ë°€ì„ ì•Œê³  ìˆëŠ”ì§€ ì—¬ë¶€
        know[0] = know[firstPerson] = True                     # ì‹œê°„ 0ì— 0ê³¼ firstPersonì€ ë¹„ë°€ì„ ì•

        def find(x):
            if parent[x] != x:                                 # ê²½ë¡œ ì••ì¶•ì„ ìœ„í•œ ì¬ê·€ íƒìƒ‰
                parent[x] = find(parent[x])                    # ë£¨íŠ¸ë¡œ ì••ì¶•
            return parent[x]                                   # ë£¨íŠ¸ ë°˜í™˜

        def union(a, b):
            pa, pb = find(a), find(b)                          # ê° ë…¸ë“œì˜ ë£¨íŠ¸ ì°¾ê¸°
            if pa != pb:                                       # ì„œë¡œ ë‹¤ë¥¸ ì§‘í•©ì´ë©´
                parent[pb] = pa                                # í•œìª½ ë£¨íŠ¸ë¥¼ ë‹¤ë¥¸ ìª½ì— ë¶™ì—¬ í•©ì¹˜ê¸°(ë­í¬ ë¯¸ì‚¬ìš©)

        i = 0                                                  # meetings ìˆœíšŒ ì¸ë±ìŠ¤
        while i < len(meetings):                               # ëª¨ë“  ë§Œë‚¨ì„ ì²˜ë¦¬í•  ë•Œê¹Œì§€ ë°˜ë³µ
            t = meetings[i][2]                                 # í˜„ì¬ ì‹œê°„ ê·¸ë£¹ì˜ ì‹œê°„ t
            temp = []                                          # í˜„ì¬ ì‹œê°„ tì— ë“±ì¥í•œ ì‚¬ëŒë“¤ì„ ëª¨ìœ¼ëŠ” ë¦¬ìŠ¤íŠ¸

            j = i                                              # ê°™ì€ ì‹œê°„ t êµ¬ê°„ì˜ ëì„ ì°¾ê¸° ìœ„í•œ í¬ì¸í„°
            while j < len(meetings) and meetings[j][2] == t:   # ê°™ì€ ì‹œê°„ tì¸ meetingsë¥¼ ëª¨ë‘ ì²˜ë¦¬
                union(meetings[j][0], meetings[j][1])          # ì‹œê°„ t ë‚´ì—ì„œ ì—°ê²°(ë™ì¼ ì‹œê°„ ì»´í¬ë„ŒíŠ¸ êµ¬ì„±)
                temp += meetings[j][:2]                        # (x, y)ë¥¼ tempì— ì¶”ê°€(í•´ë‹¹ ì‹œê°„ì— ê´€ì—¬í•œ ì‚¬ëŒ ìˆ˜ì§‘)
                j += 1                                         # ë‹¤ìŒ meetingìœ¼ë¡œ ì´ë™

            for x in temp:                                     # ì‹œê°„ tì— ë“±ì¥í•œ ì‚¬ëŒë“¤ì„ ìˆœíšŒ
                if know[x]:                                    # ê·¸ ì‚¬ëŒì´ ì´ë¯¸ ë¹„ë°€ì„ ì•Œê³  ìˆë‹¤ë©´
                    know[find(x)] = True                       # ê·¸ ì‚¬ëŒì˜ ì»´í¬ë„ŒíŠ¸ ë£¨íŠ¸ì— "ë¹„ë°€ì„ ì•„ëŠ” ì»´í¬ë„ŒíŠ¸" í‘œì‹œ

            for x in temp:                                     # ë‹¤ì‹œ ì‹œê°„ t ë“±ì¥ ì¸ì› ìˆœíšŒ
                know[x] |= know[find(x)]                       # ì»´í¬ë„ŒíŠ¸ ë£¨íŠ¸ê°€ ë¹„ë°€ì„ ì•Œë©´ êµ¬ì„±ì›ë„ ë¹„ë°€ì„ ì•Œê²Œ í•¨

            for x in temp:                                     # ì‹œê°„ t ì²˜ë¦¬ê°€ ëë‚¬ìœ¼ë¯€ë¡œ
                parent[x] = x                                  # DSU ì—°ê²°ì„ ì´ˆê¸°í™”(ì‹œê°„ëŒ€ë¥¼ ë„˜ì–´ ì—°ê²°ì´ ìœ ì§€ë˜ì§€ ì•Šê²Œ í•¨)

            i = j                                              # ë‹¤ìŒ ì‹œê°„ ê·¸ë£¹ìœ¼ë¡œ ì´ë™

        return [i for i in range(n) if know[i]]                # ìµœì¢…ì ìœ¼ë¡œ ë¹„ë°€ì„ ì•„ëŠ” ì‚¬ëŒ ì¸ë±ìŠ¤ ëª©ë¡ ë°˜í™˜

# -----------------------------------------------------
# ğŸ” ì²« ì‹œë„ ê²°ê³¼:
#   - ì‹œê°„ ì •ë ¬ í›„ ë‹¨ìˆœ ì „íŒŒ(ë˜ëŠ” ì „ì²´ ê·¸ë˜í”„ BFS) ë°©ì‹ì—ì„œ ë™ì¼ ì‹œê°„ëŒ€ ë™ì‹œ ì „íŒŒ/ì´ˆê¸°í™” ì²˜ë¦¬ê°€ ëˆ„ë½ë˜ì–´ ì˜¤ë‹µ ë˜ëŠ” TLE ë°œìƒ ê°€ëŠ¥.
#   - ë³¸ í’€ì´ëŠ” ì‹œê°„ë³„ ê·¸ë£¹í™” + DSUë¡œ ë™ì‹œ ì „íŒŒë¥¼ ë³´ì¥í•˜ì—¬ í†µê³¼.
#
# ğŸ”§ ì˜¤ë‹µ ì´ìœ  ë° ì‚¬ìš©í•œ ì•Œê³ ë¦¬ì¦˜ ê°œë…:
#   - ì£¼ìš” ì‹¤ìˆ˜ í¬ì¸íŠ¸(ì¼ë°˜ì ):
#     - ê°™ì€ ì‹œê°„ tì—ì„œì˜ ì „íŒŒë¥¼ "ìˆœì„œ"ë¡œ ì²˜ë¦¬í•´ ì˜ëª»ëœ ì—°ì‡„ ì „íŒŒ ë˜ëŠ” ëˆ„ë½ ì „íŒŒê°€ ë°œìƒ.
#     - ì‹œê°„ tê°€ ë°”ë€ í›„ì—ë„ ì—°ê²°(ê°„ì„ /ì»´í¬ë„ŒíŠ¸)ì„ ìœ ì§€í•´ ì˜ëª»ëœ ì „íŒŒê°€ ë°œìƒ.
#   - ì‚¬ìš©í•œ í•µì‹¬ ê°œë…:
#     - ì‹œê°„ ê¸°ì¤€ ì •ë ¬ ë° ì‹œê°„ ê·¸ë£¹ ì²˜ë¦¬(ë™ì¼ timestamp ì´ë²¤íŠ¸ ë¬¶ê¸°)
#     - Union-Find(DSU)ë¡œ ê°™ì€ ì‹œê°„ì— ì—°ê²°ëœ ì‚¬ëŒë“¤ì„ ì—°ê²° ì»´í¬ë„ŒíŠ¸ë¡œ êµ¬ì„±
#     - ì»´í¬ë„ŒíŠ¸ì— ë¹„ë°€ ë³´ìœ ìê°€ ì¡´ì¬í•˜ë©´ ì»´í¬ë„ŒíŠ¸ ì „ì²´ë¡œ í™•ì‚°
#     - ì‹œê°„ ê·¸ë£¹ ì²˜ë¦¬ í›„ DSU ì—°ê²° ì´ˆê¸°í™”(ì‹œê°„ëŒ€ ë…ë¦½ì„± ìœ ì§€)
#
# ğŸ“š ì‹œê°„Â·ê³µê°„ ë³µì¡ë„:
#   - ì‹œê°„ ë³µì¡ë„: O(M log M + M * Î±(N))
#     - M = len(meetings)
#     - ì •ë ¬ O(M log M), DSU ì—°ì‚°ì€ ìƒìˆ˜ì— ê°€ê¹Œìš´ ì—­ì•„ì»¤ë§Œ(Î±)
#     - ì£¼ì˜: tempì— ì¤‘ë³µ ì¸ì›ì´ ëˆ„ì ë  ìˆ˜ ìˆì–´ ìƒìˆ˜í•­ì´ ì»¤ì§ˆ ìˆ˜ ìˆìœ¼ë‚˜ ì¼ë°˜ì ìœ¼ë¡œ í†µê³¼ ê°€ëŠ¥
#   - ê³µê°„ ë³µì¡ë„: O(N + M')
#     - parent, knowê°€ O(N)
#     - tempëŠ” ê° ì‹œê°„ ê·¸ë£¹ì—ì„œ ë“±ì¥ ì¸ì› ìˆ˜(ì¤‘ë³µ í¬í•¨)ì— ë¹„ë¡€
#
# -----------------------------------------------------
# (ì„ íƒ) ë‹¤ë¥¸ íš¨ìœ¨ì  í’€ì´ ë˜ëŠ” ì•Œê³ ë¦¬ì¦˜ ì œì•ˆ:
#   - ì‹œê°„ë³„ë¡œ ì„ì‹œ ê·¸ë˜í”„ë¥¼ ë§Œë“¤ê³ , ê·¸ ì‹œê°„ ê·¸ë£¹ ë‚´ë¶€ì—ì„œ BFS/DFSë¡œ ì—°ê²° ì»´í¬ë„ŒíŠ¸ë¥¼ ì°¾ì€ ë’¤,
#     "ë¹„ë°€ ë³´ìœ ìê°€ í¬í•¨ëœ ì»´í¬ë„ŒíŠ¸ë§Œ í™•ì‚°"ì‹œí‚¤ëŠ” ë°©ì‹ë„ ê°€ëŠ¥í•˜ë‹¤(DSU ëŒ€ì‹  ê·¸ë˜í”„ íƒìƒ‰).
#   - DSU ëŒ€ì‹  "ì‹œê°„ ê·¸ë£¹ ë‚´ ì‚¬ëŒë“¤ë§Œ parentë¥¼ ë¡œì»¬ë¡œ ê´€ë¦¬"í•˜ì—¬ ì¤‘ë³µ ìŠ¤ìº”ì„ ì¤„ì´ëŠ” ìµœì í™”ë„ ê³ ë ¤ ê°€ëŠ¥(ì½”ë“œ ë³€ê²½ í•„ìš”).
