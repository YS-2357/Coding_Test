# 15662_í†±ë‹ˆë°”í€´_2.py
# -------------------------------------------------------
# âœ… ë¬¸ì œ ì„¤ëª…:
# - Tê°œì˜ í†±ë‹ˆë°”í€´ê°€ ì£¼ì–´ì§€ê³ , ê° í†±ë‹ˆë°”í€´ëŠ” 8ê°œì˜ í†±ë‹ˆ(0: Nê·¹, 1: Sê·¹)ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.
# - íŠ¹ì • í†±ë‹ˆë°”í€´ë¥¼ ì‹œê³„(1) í˜¹ì€ ë°˜ì‹œê³„(-1)ë¡œ íšŒì „ì‹œí‚¤ë©´,  
#   ê·¸ ì¸ì ‘ í†±ë‹ˆë°”í€´ë„ ì„œë¡œ ë§ë‹¿ëŠ” ê·¹ì´ ë‹¤ë¥´ë©´ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ íšŒì „í•©ë‹ˆë‹¤.
# - Kê°œì˜ íšŒì „ ëª…ë ¹ì´ ì£¼ì–´ì¡Œì„ ë•Œ, ëª¨ë“  íšŒì „ í›„
#   ê° í†±ë‹ˆì˜ 12ì‹œ ë°©í–¥(ì¸ë±ìŠ¤ 0)ì´ 1(Sê·¹)ì¸ í†±ë‹ˆì˜ ê°œìˆ˜ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.
#
# âœ… ì…ë ¥ í˜•ì‹:
# - ì²«ì§¸ ì¤„: í†±ë‹ˆë°”í€´ì˜ ê°œìˆ˜ T (1 â‰¤ T â‰¤ 1,000)
# - ë‹¤ìŒ Tì¤„: í†±ë‹ˆë°”í€´ì˜ ìƒíƒœ (0 ë˜ëŠ” 1ë¡œ êµ¬ì„±ëœ 8ìë¦¬ ë¬¸ìì—´)
# - ë‹¤ìŒ ì¤„: íšŒì „ ëª…ë ¹ì˜ ê°œìˆ˜ K
# - ë‹¤ìŒ Kì¤„: íšŒì „ì‹œí‚¬ í†±ë‹ˆë°”í€´ ë²ˆí˜¸ì™€ ë°©í–¥ (1-based ë²ˆí˜¸, ë°©í–¥: 1=ì‹œê³„, -1=ë°˜ì‹œê³„)
#
# âœ… ì¶œë ¥ í˜•ì‹:
# - Kë²ˆ íšŒì „ ëª…ë ¹ í›„, 12ì‹œ ë°©í–¥ì´ Sê·¹(1)ì¸ í†±ë‹ˆì˜ ê°œìˆ˜ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.
#
# âœ… ì…ì¶œë ¥ ì˜ˆì œ:
# ì…ë ¥:
# 4
# 10101111
# 01111101
# 11001110
# 00000010
# 2
# 3 -1
# 1 1
#
# ì¶œë ¥:
# 3
# -------------------------------------------------------

import sys

# âœ… í†±ë‹ˆë°”í€´ ê°œìˆ˜ ì…ë ¥
gear_count = int(sys.stdin.readline().strip())

# âœ… í†±ë‹ˆ ìƒíƒœë¥¼ gear_listì— ì €ì¥ (ê° í†±ë‹ˆëŠ” 0ê³¼ 1ë¡œ êµ¬ì„±ëœ ë¦¬ìŠ¤íŠ¸)
gear_list = [list(map(int, sys.stdin.readline().strip())) for _ in range(gear_count)]

# âœ… íšŒì „ ëª…ë ¹ ê°œìˆ˜ ì…ë ¥
rotation_count = int(sys.stdin.readline().strip())

# âœ… ê° ê¸°ì–´ì˜ ëˆ„ì  íšŒì „ ìƒíƒœë¥¼ ì €ì¥í•  ë°°ì—´ (ì‹œê³„ +1, ë°˜ì‹œê³„ -1 ëˆ„ì )
rotation_state = [0] * gear_count

# âœ… íšŒì „ ì‹œ ì¸ë±ìŠ¤ ê³„ì‚° ë³´ì • í•¨ìˆ˜
def adjusted_index(x):
    # í†±ë‹ˆ ì¸ë±ìŠ¤ëŠ” 0~7ì´ê³  íšŒì „ì´ ëˆ„ì ë˜ë¯€ë¡œ mod 8ì„ í†µí•´ ì¸ë±ìŠ¤ë¥¼ ê³„ì‚°
    return abs(x % 8)

# âœ… ê° íšŒì „ ëª…ë ¹ ì²˜ë¦¬ í•¨ìˆ˜
def process_rotation(target_gear, direction):
    # íšŒì „ ë°©í–¥ì„ ì„ì‹œë¡œ ê¸°ë¡í•  ë¦¬ìŠ¤íŠ¸
    temp_rotation = [0] * gear_count
    temp_rotation[target_gear] = direction  # í˜„ì¬ í†±ë‹ˆë°”í€´ëŠ” ì…ë ¥ ë°›ì€ ë°©í–¥ìœ¼ë¡œ íšŒì „

    # âœ… ì™¼ìª½ìœ¼ë¡œ ì—°ì‡„ ì „íŒŒ
    prev_direction = direction
    for left in range(target_gear, 0, -1):
        # í˜„ì¬ í†±ë‹ˆ ì™¼ìª½ì˜ 2ë²ˆê³¼ ì´ì „ í†±ë‹ˆ ì˜¤ë¥¸ìª½(6ë²ˆ) ë¹„êµ
        current_right = gear_list[left][adjusted_index(6 - rotation_state[left])]
        left_gear_left = gear_list[left - 1][adjusted_index(2 - rotation_state[left - 1])]

        if current_right != left_gear_left and prev_direction != 0:
            temp_rotation[left - 1] = -prev_direction  # ë§ë‹¿ì€ ê·¹ì´ ë‹¤ë¥´ë©´ ë°˜ëŒ€ë°©í–¥ íšŒì „
            prev_direction = -prev_direction
        else:
            break  # ê°™ì€ ê·¹ì´ë©´ ì „íŒŒ ì¢…ë£Œ

    # âœ… ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì—°ì‡„ ì „íŒŒ
    prev_direction = direction
    for right in range(target_gear, gear_count - 1):
        # í˜„ì¬ í†±ë‹ˆ ì˜¤ë¥¸ìª½ì˜ 6ë²ˆê³¼ ì´í›„ í†±ë‹ˆ ì™¼ìª½(2ë²ˆ) ë¹„êµ
        current_left = gear_list[right][adjusted_index(2 - rotation_state[right])]
        right_gear_right = gear_list[right + 1][adjusted_index(6 - rotation_state[right + 1])]

        if current_left != right_gear_right and prev_direction != 0:
            temp_rotation[right + 1] = -prev_direction
            prev_direction = -prev_direction
        else:
            break

    # âœ… íšŒì „ ìƒíƒœ ëˆ„ì 
    for idx in range(gear_count):
        rotation_state[idx] += temp_rotation[idx]

# âœ… Kë²ˆ íšŒì „ ëª…ë ¹ì„ ì…ë ¥ ë°›ì•„ ì²˜ë¦¬
for _ in range(rotation_count):
    gear_number, rotate_dir = map(int, sys.stdin.readline().split())
    process_rotation(gear_number - 1, rotate_dir)  # gear_numberëŠ” 1-basedì´ë¯€ë¡œ -1 ì²˜ë¦¬

# âœ… ì ìˆ˜ ê³„ì‚° (12ì‹œ ë°©í–¥ì´ 1ì¸ í†±ë‹ˆ ê°œìˆ˜)
result = 0
for i in range(gear_count):
    # í˜„ì¬ 12ì‹œ ë°©í–¥ í†±ë‹ˆ ìƒíƒœ í™•ì¸
    if gear_list[i][adjusted_index(-rotation_state[i])] == 1:
        result += 1

# âœ… ìµœì¢… ê²°ê³¼ ì¶œë ¥
print(result)

# -------------------------------------------------------
# âœ… ë¬¸ì œ í’€ì´ ë°©ì‹ (ìƒì„¸ ì„¤ëª…):
#
# ğŸ“š í•µì‹¬ ê°œë…:
# - í†±ë‹ˆë°”í€´ íšŒì „ì€ ì§ì ‘ deque.rotate() í•˜ëŠ” ëŒ€ì‹ , 
#   'ëˆ„ì  íšŒì „ ìƒíƒœ'ë¡œ ì¸ë±ìŠ¤ë¥¼ ê°„ì ‘ ì¡°ì ˆí•©ë‹ˆë‹¤.
#
# ğŸ›  ì•Œê³ ë¦¬ì¦˜ ë‹¨ê³„:
# 1ï¸âƒ£ ì…ë ¥ë°›ì€ í†±ë‹ˆ ìƒíƒœë¥¼ gear_listì— ì €ì¥í•©ë‹ˆë‹¤.
# 2ï¸âƒ£ íšŒì „ ìƒíƒœë¥¼ ì €ì¥í•  rotation_state ë°°ì—´ì„ ì¤€ë¹„í•©ë‹ˆë‹¤.
#    ì´ ë°°ì—´ì˜ ê° ì›ì†ŒëŠ” "íšŒì „ íšŒìˆ˜(ë°©í–¥ í¬í•¨)"ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
#
# 3ï¸âƒ£ ê° íšŒì „ ëª…ë ¹ì„ ì²˜ë¦¬í•  ë•Œ:
#     (1) í•´ë‹¹ í†±ë‹ˆì˜ íšŒì „ ë°©í–¥ì„ temp_rotation ë°°ì—´ì— ê¸°ë¡í•©ë‹ˆë‹¤.
#     (2) ì™¼ìª½ ë°©í–¥ìœ¼ë¡œ ì „íŒŒ:
#         - í˜„ì¬ í†±ë‹ˆì˜ 6ë²ˆ ì¸ë±ìŠ¤ì™€ ì™¼ìª½ í†±ë‹ˆì˜ 2ë²ˆ ì¸ë±ìŠ¤ ê·¹ì„ ë¹„êµí•´ 
#           ë‹¤ë¥´ë©´ ë°˜ëŒ€ë°©í–¥ íšŒì „, ê°™ìœ¼ë©´ ì „íŒŒ ì¤‘ì§€.
#     (3) ì˜¤ë¥¸ìª½ ë°©í–¥ ì „íŒŒë„ ê°™ì€ ì›ë¦¬ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.
#     (4) ë§ˆì§€ë§‰ìœ¼ë¡œ rotation_stateì— temp_rotationì„ ëˆ„ì í•©ë‹ˆë‹¤.
#
# 4ï¸âƒ£ ëª¨ë“  íšŒì „ì´ ëë‚œ í›„, 
#     gear[i][adjusted_index(-rotation_state[i])]ë¥¼ í†µí•´ 
#     í˜„ì¬ 12ì‹œ ë°©í–¥ í†±ë‹ˆ ê·¹ì„±ì„ í™•ì¸í•©ë‹ˆë‹¤.
#
# 5ï¸âƒ£ 12ì‹œ ë°©í–¥ì´ 1ì¸ í†±ë‹ˆì˜ ê°œìˆ˜ë¥¼ ì„¸ì–´ ì¶œë ¥í•©ë‹ˆë‹¤.
#
# ğŸ§© ì‘ì€ ì‹œë®¬ë ˆì´ì…˜ ì˜ˆ:
# - í†±ë‹ˆ Aì™€ Bì˜ ë§ë‹¿ëŠ” ê·¹ì´ ì„œë¡œ ë‹¤ë¥´ë©´:
#     A íšŒì „ â†’ BëŠ” -A ë°©í–¥ìœ¼ë¡œ íšŒì „ â†’ Cë„ ì¡°ê±´ì— ë”°ë¼ íšŒì „ ì—¬ë¶€ ê²°ì •
# - ìµœì¢…ì ìœ¼ë¡œ ëª¨ë“  í†±ë‹ˆì˜ íšŒì „ìƒíƒœë¥¼ ê³„ì‚° í›„ ì ìˆ˜ë¥¼ ëˆ„ì í•©ë‹ˆë‹¤.
#
# ğŸš€ ì‹œê°„ ë³µì¡ë„:
# - O(K * T) (K: íšŒì „ íšŸìˆ˜, T: í†±ë‹ˆ ìˆ˜) ì¶©ë¶„íˆ í†µê³¼ ê°€ëŠ¥.
#
# âœ… ì´ ë°©ë²•ì˜ ì¥ì :
# - íšŒì „ ì‹œë§ˆë‹¤ dequeë¥¼ ëŒë¦¬ì§€ ì•Šê³ , O(1)ë¡œ ì¸ë±ìŠ¤ë§Œ ì¡°ì • ê°€ëŠ¥
# - ë©”ëª¨ë¦¬ íš¨ìœ¨ ë° ì—°ì‚° íš¨ìœ¨ì´ ìš°ìˆ˜
# -------------------------------------------------------
